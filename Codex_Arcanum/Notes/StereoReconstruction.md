# 双目立体视觉三维重建
## 1. 坐标转换基础
### 1.1 **物理空间坐标系（世界坐标系，World Frame）**
   - **定义**：物体在真实三维空间中的坐标，记为 \( \mathbf{P}_w = [X_w, Y_w, Z_w, 1]^T \)（齐次坐标）。
   - **特点**：这是一个全局坐标系，用于描述物体和相机的位置关系。

---

### 1.2 **相机空间坐标系（Camera Frame）**
   - **定义**：以相机光心为原点、光轴为 \( Z_c \) 轴的坐标系，记为 \( \mathbf{P}_c = [X_c, Y_c, Z_c, 1]^T \)。
   - **转换方法**：通过 **刚体变换（Rigid Transformation）** 将世界坐标转换到相机坐标：
     \[
     \mathbf{P}_c = \mathbf{T}_{cw} \cdot \mathbf{P}_w
     \]
     其中：
     - \( \mathbf{T}_{cw} \) 是 \( 4 \times 4 \) 的变换矩阵，包含：
       - **旋转矩阵 \( \mathbf{R}_{3 \times 3} \)**：描述相机坐标系相对于世界坐标系的旋转。
       - **平移向量 \( \mathbf{t}_{3 \times 1} \)**：描述相机光心在世界坐标系中的位置。
     - 展开形式：
       \[
       \begin{bmatrix} X_c \\ Y_c \\ Z_c \\ 1 \end{bmatrix} = 
       \begin{bmatrix} \mathbf{R} & \mathbf{t} \\ \mathbf{0} & 1 \end{bmatrix}
       \begin{bmatrix} X_w \\ Y_w \\ Z_w \\ 1 \end{bmatrix}
       \]

   - **关键点**：
     - 旋转矩阵 \( \mathbf{R} \) 是正交矩阵（\( \mathbf{R}^T \mathbf{R} = \mathbf{I} \)）。
     - 平移向量 \( \mathbf{t} \) 是相机光心在世界坐标系中的坐标。

---

### 1.3 **像平面坐标系（Image Plane Frame）**
   - **定义**：相机光心投影到成像平面上的二维坐标，记为 \( \mathbf{p} = [x, y]^T \)。
   - **转换方法**：通过 **透视投影（Perspective Projection）** 将相机坐标投影到像平面：
     1. **归一化平面投影**：将 \( \mathbf{P}_c \) 投影到归一化平面（\( Z_c = 1 \)）：
        \[
        x' = \frac{X_c}{Z_c}, \quad y' = \frac{Y_c}{Z_c}
        \]
     2. **考虑内参**：通过相机内参矩阵 \( \mathbf{K} \) 转换到像素坐标：
        \[
        \mathbf{p} = \mathbf{K} \begin{bmatrix} x' \\ y' \\ 1 \end{bmatrix}, \quad 
        \mathbf{K} = \begin{bmatrix} f_x & 0 & c_x \\ 0 & f_y & c_y \\ 0 & 0 & 1 \end{bmatrix}
        \]
        - \( f_x, f_y \)：焦距（像素单位）。
        - \( c_x, c_y \)：主点坐标（像平面中心）。

   - **关键点**：
     - 透视投影是非线性操作（除以 \( Z_c \)）。
     - 内参矩阵 \( \mathbf{K} \) 描述了相机的光学特性（如焦距、畸变等）。

---

### 1.4 **完整转换流程总结**
   1. **世界坐标 → 相机坐标**：  
      \[
      \mathbf{P}_c = \mathbf{T}_{cw} \cdot \mathbf{P}_w
      \]
   2. **相机坐标 → 归一化坐标**：  
      \[
      x' = X_c / Z_c, \quad y' = Y_c / Z_c
      \]
   3. **归一化坐标 → 像素坐标**：  
      \[
      \begin{bmatrix} u \\ v \\ 1 \end{bmatrix} = 
      \mathbf{K} \begin{bmatrix} x' \\ y' \\ 1 \end{bmatrix}
      \]

---

### 1.5 **示例（简化版）**
假设：
- 世界坐标 \( \mathbf{P}_w = [1, 0, 2, 1]^T \)。
- 相机外参：旋转 \( \mathbf{R} = \mathbf{I} \)，平移 \( \mathbf{t} = [0, 0, -1]^T \)（相机后退1单位）。
- 内参：\( f_x = f_y = 500 \)，\( c_x = c_y = 320 \)。

**步骤**：
1. 相机坐标：  
   \[
   \mathbf{P}_c = \mathbf{T}_{cw} \cdot \mathbf{P}_w = [1, 0, 1, 1]^T
   \]
2. 归一化坐标：  
   \[
   x' = 1/1 = 1, \quad y' = 0/1 = 0
   \]
3. 像素坐标：  
   \[
   u = 500 \cdot 1 + 320 = 820, \quad v = 500 \cdot 0 + 320 = 320
   \]

---

### 1.6 **常见问题**
   - **为什么需要齐次坐标？**  
     为了统一表示旋转和平移（线性变换）。
   - **内参矩阵的作用？**  
     将物理长度（毫米）转换为像素单位，并处理图像传感器的不对称性（如非方形像素）。
   - **畸变如何处理？**  
     在归一化坐标后，需额外应用径向/切向畸变模型校正。

---
### **1.6 真实世界因素考虑**
在从 **世界坐标系 → 相机坐标系 → 像平面坐标系** 的转换中，是否需要通过 **显式引入缩放系数消除 \( Z \) 轴影响**，本质上取决于是否要保留深度信息。

---

- **透视投影的本质**：在透视投影中，\( Z_c \)（相机坐标系下的深度）会导致物体在像平面上的尺寸随距离变化（近大远小）。若直接使用未归一化的坐标，会导致投影后的坐标受 \( Z_c \) 非线性影响。
- **是否需要消除 \( Z \) 轴影响**：
  - **情况1**：如果目标是获取 **像平面上的纯几何坐标**（如像素位置），则必须通过除以 \( Z_c \) 完成归一化（即透视除法）。
  - **情况2**：如果目标是保留深度信息（如三维重建），则需单独存储 \( Z_c \)，而非通过矩阵乘法消除它。

---

### **1.7 完整推导（含归一化步骤）**
#### **(1) 世界坐标 → 相机坐标**
\[
\begin{bmatrix} X_c \\ Y_c \\ Z_c \\ 1 \end{bmatrix} = 
\begin{bmatrix} \mathbf{R} & \mathbf{t} \\ \mathbf{0} & 1 \end{bmatrix}
\begin{bmatrix} X_w \\ Y_w \\ Z_w \\ 1 \end{bmatrix}
\]
- 此时 \( Z_c \) 表示物体到相机光心的距离。

#### **(2) 相机坐标 → 归一化坐标（关键步骤）**
为了消除 \( Z_c \) 对像平面坐标的影响，需进行 **归一化**：
\[
x = \frac{X_c}{Z_c}, \quad y = \frac{Y_c}{Z_c}, \quad z = \frac{Z_c}{Z_c} = 1
\]
- **数学解释**：这等价于将相机坐标投影到 **归一化平面**（\( Z_c = 1 \) 的平面）。
- **几何意义**：所有位于同一条射线上的点（即 \( (X_c, Y_c, Z_c) \) 和 \( (kX_c, kY_c, kZ_c) \)）会投影到同一个 \( (x, y) \) 点。

#### **(3) 归一化坐标 → 像素坐标**
通过内参矩阵 \( \mathbf{K} \) 转换：
\[
\begin{bmatrix} u \\ v \\ 1 \end{bmatrix} = 
\mathbf{K} \begin{bmatrix} x \\ y \\ 1 \end{bmatrix}, \quad 
\mathbf{K} = \begin{bmatrix} f_x & \gamma & c_x \\ 0 & f_y & c_y \\ 0 & 0 & 1 \end{bmatrix}
\]

---

### **1.8 为什么不能直接用矩阵乘法消除 \( Z \)?**
#### **(1) 尝试构造“消除 \( Z \)”的矩阵**
假设我们强行构造一个 \( 4 \times 4 \) 矩阵 \( \mathbf{M} \)，试图通过一次乘法完成归一化：
\[
\mathbf{M} = \begin{bmatrix} 
1 & 0 & 0 & 0 \\ 
0 & 1 & 0 & 0 \\ 
0 & 0 & 1 & 0 \\ 
0 & 0 & 1 & 0 
\end{bmatrix}
\]
- 作用效果：
  \[
  \mathbf{M} \begin{bmatrix} X_c \\ Y_c \\ Z_c \\ 1 \end{bmatrix} = 
  \begin{bmatrix} X_c \\ Y_c \\ Z_c \\ Z_c \end{bmatrix}
  \]
- 齐次坐标归一化后：
  \[
  \begin{bmatrix} X_c/Z_c \\ Y_c/Z_c \\ Z_c/Z_c \\ 1 \end{bmatrix} = 
  \begin{bmatrix} x \\ y \\ 1 \\ 1 \end{bmatrix}
  \]
- **问题**：这种构造虽然形式上实现了归一化，但破坏了矩阵乘法的线性性质，且无法与后续内参矩阵 \( \mathbf{K} \) 直接相乘（因为 \( \mathbf{K} \) 是 \( 3 \times 3 \)）。

#### **(2) 根本原因**
- **非线性性**：透视除法（除以 \( Z_c \)）是一个非线性操作，无法通过单一的线性矩阵乘法实现。
- **投影矩阵的局限性**：在计算机图形学中，投影矩阵（如OpenGL的透视矩阵）仅能通过将 \( Z_c \) 映射到裁剪空间，但不能消除它对 \( (x, y) \) 的影响。

---

### **1.9 综合公式（完整流程）**
将世界坐标 \( \mathbf{P}_w \) 转换到像素坐标 \( \mathbf{p} \) 的完整步骤：
\[
\mathbf{p} = \mathbf{K} \cdot 
\underbrace{
\begin{bmatrix} 
\frac{X_c}{Z_c} \\ 
\frac{Y_c}{Z_c} \\ 
1 
\end{bmatrix}
}_{\text{归一化坐标}}
= \mathbf{K} \cdot 
\left( 
\underbrace{
\begin{bmatrix} 
\mathbf{R} & \mathbf{t} \\ 
\mathbf{0} & 1 
\end{bmatrix}
\mathbf{P}_w
}_{\text{相机坐标}}
\right)_{1:3} \Big/ Z_c
\]
- 其中 \( (\cdot)_{1:3} \) 表示取前三个分量（\( X_c, Y_c, Z_c \)）。

---

### **1.10 特殊情况讨论**
#### **(1) 正交投影（无透视效应）**
- 当相机为 **正交投影模型** 时，\( Z_c \) 不影响 \( (x, y) \) 坐标。此时投影矩阵直接丢弃 \( Z_c \)：
  \[
  \begin{bmatrix} x \\ y \end{bmatrix} = 
  \begin{bmatrix} f_x & 0 & c_x \\ 0 & f_y & c_y \end{bmatrix}
  \begin{bmatrix} X_c \\ Y_c \\ 1 \end{bmatrix}
  \]
- 但正交投影不适用于大多数真实相机（仅用于CAD等场景）。

#### **(2) 深度信息的保留**
- 若需要保留 \( Z_c \)（如深度图生成），可在归一化后单独存储：
  \[
  \text{深度} = Z_c \quad \text{或} \quad \text{归一化深度} = \frac{Z_c - Z_{\text{min}}}{Z_{\text{max}} - Z_{\text{min}}}
  \]

---

### **1.11 代码验证（Python示例）**
```python
import numpy as np

# 定义外参和内参
R = np.eye(3)  # 无旋转
t = np.array([0, 0, 1])  # 相机向后退1单位
K = np.array([[500, 0, 320], [0, 500, 240], [0, 0, 1]])  # 内参

# 世界坐标 (X_w, Y_w, Z_w)
P_w = np.array([1, 0, 2, 1])  # 齐次坐标

# 世界 → 相机坐标
T_cw = np.vstack((np.hstack((R, t.reshape(3,1))), [0, 0, 0, 1]))
P_c = T_cw @ P_w  # X_c=1, Y_c=0, Z_c=3

# 归一化并转换到像素坐标
x, y = P_c[0]/P_c[2], P_c[1]/P_c[2]
u = K[0,0] * x + K[0,2]  # 500*(1/3) + 320 ≈ 486.67
v = K[1,1] * y + K[1,2]  # 500*(0/3) + 240 = 240
```

---

### **总结**
- **必须显式归一化**：无法通过单一的矩阵乘法消除 \( Z_c \) 的影响，必须通过除以 \( Z_c \) 完成透视除法。
- **数学本质**：透视投影是非线性的，而矩阵乘法是线性的，二者无法完全等价。
- **实际应用**：在SLAM、三维重建中，归一化后的坐标 \( (x, y) \) 和深度 \( Z_c \) 通常分开处理。

## 2. 射影几何基础
### 2.1 二维射影空间
#### 2.1.1 如何理解二维射影空间
二维射影空间（Projective Plane，记作 \(\mathbb{RP}^2\)）可以直观理解为在普通欧氏平面基础上加入“无穷远点”的扩展空间。

---

**1. 平行直线的“交点”在哪里？**
   - **欧氏平面问题**：在普通平面中，两条平行直线永不相交。但在射影几何中，我们希望统一“相交”的性质，认为平行直线也相交——只是交点在“无穷远处”。
   - **射影平面的解决**：将每条平行直线族（如所有斜率为2的直线）分配一个共同的“无穷远点”，作为它们的交点。所有无穷远点组成一条“无穷远直线”。

   **直观比喻**：想象你站在铁轨中间，两条铁轨在远处看似相交。这个“消失点”就是射影平面中平行直线的交点。

---

 **2. 齐次坐标：用三维看二维**
   - 二维射影空间的点可以用三维齐次坐标 \((x, y, w)\) 表示（\(w \neq 0\)），其中 \((x, y, w)\) 和 \((kx, ky, kw)\)（\(k \neq 0\)）代表同一个点。
   - 当 \(w \to 0\) 时，点趋向无穷远（如 \((1, 2, 0)\) 是斜率为2的平行直线族的交点）。

**核心问题：为什么要用三维坐标表示二维点？**
在欧氏平面 \(\mathbb{R}^2\) 中，一个点直接用 \((x, y)\) 表示。但在射影平面 \(\mathbb{RP}^2\) 中，我们需要表示两类点：
- **普通点**：如 \((2, 3)\)（对应 \(w=1\)）。
- **无穷远点**：如“斜率为2的直线交点”（对应 \(w=0\)）。

为了统一表示这两类点，数学家引入了齐次坐标：**用三维空间中的一条直线（穿过原点的线）代表二维射影平面中的一个点**。

**具体步骤：从三维直线到二维点**
**(1) 三维空间中的直线**
想象一个三维空间 \((x, y, w)\)，取所有穿过原点的直线。每条这样的直线代表 \(\mathbb{RP}^2\) 中的一个点。

**(2) 如何对应到二维平面？**
- **普通点**：取 \(w=1\) 的平面，直线 \((x, y, w)\) 与该平面交于 \((x, y, 1)\)。  
  例如：直线 \( (2t, 3t, t) \) 对应二维点 \((2, 3)\)（因为 \(t=1\) 时交于 \((2, 3, 1)\)）。  
  **关键**：直线上的所有点 \((2t, 3t, t)\) 都对应同一个二维点 \((2, 3)\)（因为齐次坐标允许整体缩放）。

- **无穷远点**：当 \(w=0\)，直线 \((x, y, 0)\) 不与 \(w=1\) 平面相交，但它代表一个“无穷远点”。  
  例如：直线 \( (1, 2, 0) \) 对应斜率为2的平行直线族的交点（即“无穷远点”）。

**(3) 为什么 \(w=0\) 是无穷远？**
- 在齐次坐标中，点 \((x, y, w)\) 等价于 \((x/w, y/w, 1)\)（若 \(w \neq 0\)）。  
- 当 \(w \to 0\)，坐标 \((x/w, y/w)\) 趋向无限大，因此 \(w=0\) 的点无法用有限坐标表示，只能视为“无穷远”。

**几何直观：投影（Projection）**
- **操作**：将三维空间中穿过原点的直线**投影**到 \(w=1\) 的平面上。
  - 若直线与平面相交 → 得到普通点。
  - 若直线平行于平面（即 \(w=0\)）→ 投影到“无穷远”。

**例子**
- **普通点**：齐次坐标 \((4, 6, 2)\) 和 \((2, 3, 1)\) 代表同一个二维点 \((2, 3)\)（因为 \( (4,6,2) = 2 \cdot (2,3,1) \)）。
- **无穷远点**：\((1, -1, 0)\) 代表所有斜率为-1的平行直线的“交点”。

*为什么这样设计？**
- **统一性**：普通点和无穷远点用同一套坐标表示。
- **计算方便**：射影变换（如相机成像）在齐次坐标下可以写成线性矩阵乘法。
- 
**总结**
- **齐次坐标的本质**：用三维空间中穿过原点的直线表示二维射影平面的点。
- **无穷远点的来源**：当直线平行于 \(w=1\) 平面（即 \(w=0\)）时，投影到“无限远”。
- **关键规则**：缩放齐次坐标不改变对应的二维点，即 \((x,y,w) \equiv (kx,ky,kw)\)。

试着想象：三维空间中所有倾斜的直线对应普通点，而水平的直线（\(w=0\)）对应无穷远点。这就是“用三维看二维”的核心思想。

---

**3. 实际应用中的直观**
   - **计算机视觉**：相机拍摄的“消失点”就是射影空间中平行直线的交点。
   - **艺术透视**：绘画中的透视法天然遵循射影几何的规则。

---

**定理**
二维射影空间的核心是：
1. **统一相交性**：任何两条直线必有一个交点（普通点或无穷远点）。
2. **齐次性**：点的表示不依赖具体坐标尺度。
3. **紧化**：欧氏平面+无穷远元素=紧致的射影平面。

你可以想象它是一个“闭合”的平面，所有方向上的无穷远点最终连接成一条无穷远直线，形成一个没有边界的空间。

### 2.1.2 直线的交点
在二维射影空间（\(\mathbb{RP}^2\)）中，**任意两条直线必有一个交点**（包括普通点和无穷远点）。这一性质是射影几何的核心优势。下面我们通过**齐次坐标**和具体例子推导直线的交点。

---

**1. 射影直线的表示**
在 \(\mathbb{RP}^2\) 中，一条直线可以用齐次坐标的线性方程表示：  
\[
aX + bY + cW = 0  
\]  
其中，\((a,b,c)\) 为直线的齐次坐标，不全为零。
- **注**：\((a,b,c)\) 和 \((ka, kb, kc)\)（\(k \neq 0\)）表示同一条直线（因齐次坐标的缩放不变性）。

---

**2. 两条直线的交点推导**
设两条直线 \(L_1\) 和 \(L_2\) 的方程分别为：  
\[
\begin{cases}
L_1: a_1X + b_1Y + c_1W = 0 \\
L_2: a_2X + b_2Y + c_2W = 0
\end{cases}
\]  
它们的交点 \((X, Y, W)\) 需同时满足这两个方程。  
这等价于求解以下齐次线性方程组：  
\[
\begin{bmatrix}
a_1 & b_1 & c_1 \\
a_2 & b_2 & c_2
\end{bmatrix}
\begin{bmatrix}
X \\ Y \\ W
\end{bmatrix}
= 0
\]

**解的性质**
- 方程组有**非零解**（因为两条直线不重合时秩为2，解空间维数为1，即一条穿过原点的直线，对应射影平面中的一个点）。
- 解的唯一性：两条直线在 \(\mathbb{RP}^2\) 中**必相交于唯一一点**（可能是无穷远点）。

---

**3. 具体求解方法**

**步骤1：构造叉积（Cross Product）**

两条直线的齐次坐标向量分别为\(\mathbf{l}_1 = (a_1, b_1, c_1)\) 和 \(\mathbf{l}_2 = (a_2, b_2, c_2)\)。 它们的交点 \(\mathbf{p} = (X, Y, W)\) 是这两个向量的叉积：\[
\mathbf{p} = \mathbf{l}_1 \times \mathbf{l}_2
\] 

即：
\[
\begin{bmatrix}
X\\
Y\\
W
\end{bmatrix}= 
\begin{bmatrix}
b_1 c_2 - b_2 c_1 \\
a_2 c_1 - a_1 c_2 \\
a_1 b_2 - a_2 b_1
\end{bmatrix}
\]


**步骤2：分析交点类型**
- **普通点**：若 \(W \neq 0\)，则交点为 \((X/W, Y/W)\)（欧氏平面中的普通点）。  
- **无穷远点**：若 \(W = 0\)，则交点为 \((X, Y, 0)\)（平行直线的“无穷远交点”）。

---

**4. 例子**
**例1：两条普通直线相交**
设两条直线：  
\[
\begin{cases}
L_1: X + Y - W = 0 \quad (\mathbf{l}_1 = (1, 1, -1)) \\
L_2: X - Y + W = 0 \quad (\mathbf{l}_2 = (1, -1, 1))
\end{cases}
\]  
计算叉积：  
\[
\mathbf{p} = \mathbf{l}_1 \times \mathbf{l}_2 =
\begin{vmatrix}
\mathbf{i} & \mathbf{j} & \mathbf{k} \\
1 & 1 & -1 \\
1 & -1 & 1
\end{vmatrix}
= (0, -2, -2)
\]  
归一化（取 \(W=-2\)）：  
\[
\mathbf{p} \equiv (0/(-2), -2/(-2), -2/(-2)) = (0, 1, 1)
\]  
对应欧氏平面中的点 \((0, 1)\)。

**例2：两条平行直线（交于无穷远）**
设两条平行直线：  
\[
\begin{cases}
L_1: X + Y - W = 0 \quad (\mathbf{l}_1 = (1, 1, -1)) \\
L_2: X + Y - 2W = 0 \quad (\mathbf{l}_2 = (1, 1, -2))
\end{cases}
\]  
计算叉积：  
\[
\mathbf{p} = \mathbf{l}_1 \times \mathbf{l}_2 =
\begin{vmatrix}
\mathbf{i} & \mathbf{j} & \mathbf{k} \\
1 & 1 & -1 \\
1 & 1 & -2
\end{vmatrix}
= (-1, 1, 0)
\]  
因为 \(W=0\)，所以交点为 \((-1, 1, 0)\)，表示斜率为1的平行直线族的无穷远点。

---

**5. 几何意义**
- **普通交点**：对应欧氏平面中两条非平行直线的交点。  
- **无穷远交点**：当两条直线平行时（即 \(\mathbf{l}_1\) 和 \(\mathbf{l}_2\) 的前两项成比例），叉积的 \(W\) 分量为0，此时交点为无穷远点。  
  - 例如，所有斜率为 \(k\) 的平行直线相交于同一个无穷远点 \((1, k, 0)\)。

---

**6. 为什么这是统一的？**
在射影几何中，**无穷远点与普通点地位平等**。通过齐次坐标和叉积：  
- 平行直线的交点不再需要单独讨论，而是自然落在 \(W=0\) 的无穷远直线上。  
- 所有直线的相交性被完美统一。

---

**总结**
1. **交点公式**：\(\mathbf{p} = \mathbf{l}_1 \times \mathbf{l}_2\)。  
2. **无穷远点**：当叉积的 \(W=0\) 时，交点位于无穷远。  
3. **统一性**：射影平面中不存在“平行”的概念，任何两条直线必相交。  

这种方法的强大之处在于，它将欧氏几何中需要分类讨论的情况（相交/平行）统一为一种代数运算（叉积）。

#### 2.1.2 两点确定一条直线
在二维射影空间（\(\mathbb{RP}^2\)）中，**任意两点确定唯一一条直线**，这一性质与欧氏几何一致，但通过齐次坐标的表示更加统一（包括无穷远点和普通点）。

---

**1. 射影点的表示**
在 \(\mathbb{RP}^2\) 中，一个点用齐次坐标表示为 \(\mathbf{p} = (X, Y, W)\)，其中：
- 若 \(W \neq 0\)，对应欧氏平面的普通点 \((x, y) = (X/W, Y/W)\)；
- 若 \(W = 0\)，对应无穷远点（如方向为 \((X, Y)\) 的平行直线交点）。

---
**2. 直线的齐次坐标表示**
一条直线在 \(\mathbb{RP}^2\) 中的方程为：  
\[
aX + bY + cW = 0 \quad \text{（直线齐次坐标：} \mathbf{l} = (a, b, c) \text{）}
\]  
- **关键性质**：直线坐标 \(\mathbf{l}\) 也可以缩放（与点坐标一样，\((a,b,c)\) 和 \(k(a,b,c)\) 表示同一条直线）。

---

**3. 连接两点的直线推导**
设两点 \(\mathbf{p}_1 = (X_1, Y_1, W_1)\) 和 \(\mathbf{p}_2 = (X_2, Y_2, W_2)\)，求通过它们的直线 \(\mathbf{l}\)。

#### **方法1：叉积法（最直接）**

射影空间中，两点 \(\mathbf{p}_1\) 和 \(\mathbf{p}_2\) 的连线 \(\mathbf{l}\) 是它们的叉积：  \[
\mathbf{l} = \mathbf{p}_1 \times \mathbf{p}_2
\]

展开为：  
\[
\mathbf{l} = 
\begin{bmatrix}
a \\ b \\ c\end{bmatrix}=
\begin{bmatrix}
Y_1 W_2 - Y_2 W_1 \\
X_2 W_1 - X_1 W_2 \\
X_1 Y_2 - X_2 Y_1
\end{bmatrix}
\]

**为什么叉积是直线？**  
因为 \(\mathbf{l}\) 同时满足 \(\mathbf{l}^\top \mathbf{p}_1 = 0\) 和 \(\mathbf{l}^\top \mathbf{p}_2 = 0\)，即两点均在直线上。

---

**方法2：代数法（验证叉积的正确性）**
设直线方程为 \(aX + bY + cW = 0\)，代入两点坐标：  
\[
\begin{cases}
a X_1 + b Y_1 + c W_1 = 0 \\
a X_2 + b Y_2 + c W_2 = 0
\end{cases}
\]  
这是一个关于 \((a, b, c)\) 的齐次线性方程组，其非零解即为直线坐标。  
叉积的结果正是该方程组的解空间基向量。

---

**4. 例子**
**例1：连接两个普通点**
设两点：  \[
\mathbf{p}_1 = (2, 3, 1) \quad \text{（欧氏点} (2, 3)\text{）}\\
\mathbf{p}_2 = (4, 1, 1) \quad \text{（欧氏点} (4, 1)\text{）}
\]  
计算叉积：  
\[
\mathbf{l} = \mathbf{p}_1 \times \mathbf{p}_2 =
\begin{bmatrix}
3 \cdot 1 - 1 \cdot 1 \\
4 \cdot 1 - 2 \cdot 1 \\
2 \cdot 1 - 4 \cdot 3
\end{bmatrix}=
\begin{bmatrix}
2 \\ 2 \\ -10
\end{bmatrix}
\]  
可简化为 \(\mathbf{l} = (1, 1, -5)\)（整体除以2），对应直线方程：  
\[
X + Y - 5W = 0 \quad \text{（欧氏平面中：} x + y - 5 = 0 \text{）}
\]

#### **例2：连接普通点与无穷远点**
设两点：  
\[
\mathbf{p}_1 = (1, 2, 1) \quad \text{（欧氏点} (1, 2)\text{）} \\
\mathbf{p}_2 = (1, 1, 0) \quad \text{（斜率为1的无穷远点）}
\]  
计算叉积：  
\[
\mathbf{l} = \mathbf{p}_1 \times \mathbf{p}_2 = \begin{bmatrix}
2 \cdot 0 - 1 \cdot 1 \\
1 \cdot 1 - 1 \cdot 0 \\
1 \cdot 1 - 1 \cdot 2 \end{bmatrix} = \begin{bmatrix}
-1 \\ 1 \\ -1 \end{bmatrix}
\]  
简化为 \(\mathbf{l} = (1, -1, 1)\)，对应直线方程：  
\[
X - Y + W = 0 \quad \text{（欧氏平面中：} x - y + 1 = 0 \text{）}
\]  
**几何意义**：这是通过 \((1, 2)\) 且斜率为1的直线（与无穷远点 \(\mathbf{p}_2\) 的方向一致）。

#### **例3：连接两个无穷远点**
设两点：  
\[
\mathbf{p}_1 = (1, 0, 0) \quad \text{（水平方向的无穷远点）} \\
\mathbf{p}_2 = (0, 1, 0) \quad \text{（竖直方向的无穷远点）}
\]  
计算叉积：  
\[
\mathbf{l} = \mathbf{p}_1 \times \mathbf{p}_2 = \begin{bmatrix}
0 \cdot 0 - 1 \cdot 0 \\
0 \cdot 0 - 1 \cdot 0 \\
1 \cdot 1 - 0 \cdot 0 \end{bmatrix} = \begin{bmatrix}
0 \\ 0 \\ 1 \end{bmatrix}
\]  
对应直线方程：  
\[
0 \cdot X + 0 \cdot Y + 1 \cdot W = 0 \quad \text{即} \quad W = 0
\]  
**几何意义**：这是射影平面中的**无穷远直线**（所有无穷远点的集合）。

---

**5. 几何直观**
- **普通点连线**：与欧氏几何一致，但用齐次坐标计算。  
- **含无穷远点的连线**：  
  - 普通点 + 无穷远点 → 通过该点且方向与无穷远点相同的直线。  
  - 两个无穷远点 → 无穷远直线。  
- **统一性**：无论点是否为无穷远，叉积法均适用。

---

**6. 为什么叉积有效？**
- 叉积的结果向量 \(\mathbf{l}\) 与 \(\mathbf{p}_1\) 和 \(\mathbf{p}_2\) 均正交（即 \(\mathbf{l}^\top \mathbf{p}_1 = \mathbf{l}^\top \mathbf{p}_2 = 0\)），因此两点均在直线上。  
- 叉积的几何意义在射影空间中扩展为“连接操作”。

---

**总结**
1. **公式**：两点 \(\mathbf{p}_1, \mathbf{p}_2\) 的连线为 \(\mathbf{l} = \mathbf{p}_1 \times \mathbf{p}_2\)。  
2. **无穷远点的作用**：  
   - 若一点为无穷远，连线方向由其决定；  
   - 两点均为无穷远时，连线是无穷远直线。  
3. **统一性**：无需区分点的类型，代数运算自动处理所有情况。  

这种方法的优雅之处在于，它将欧氏几何中需要特殊处理的“方向”和“平行性”自然融入齐次坐标的代数框架中。